!function(){"use strict";function e(e){WScript.StdOut.Write(encodeURI(JSON.stringify(e)))}function t(e,t){var n=[],r=!!t,o=e.Fields,u=o.Count;if(!e.BOF||!e.EOF){var i,f,c,a,s,l,p,y,O,g;for(e.MoveFirst();!e.EOF;){for(g={},i=0;i<u;i++)if(O=o.Item(i),y=O.Name,"date"==typeof(c=O.Value)&&(c=new Date(c)),r){for(s={},p=(l=O.Properties).Count,f=0;f<p;f++)s[(a=l.Item(f)).Name]={Type:a.Type,Value:a.Value};g[y]={ActualSize:O.ActualSize,Attributes:O.Attributes,DefinedSize:O.DefinedSize,NumericScale:O.NumericScale,Precision:O.Precision,Type:O.Type,Properties:s,Value:c}}else g[y]=c;n.push(g),e.MoveNext()}}return n}function n(e){e.State&&e.Close()}"object"!=typeof JSON&&(JSON={}),function(){function e(e){return e<10?"0"+e:e}function t(){return this.valueOf()}function n(e){return c.lastIndex=0,c.test(e)?'"'+e.replace(c,function(e){var t=p[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function r(e,t){var o,u,i,f,c,a=s,p=t[e];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(e)),"function"==typeof y&&(p=y.call(t,e,p)),typeof p){case"string":return n(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(s+=l,c=[],"[object Array]"===Object.prototype.toString.apply(p)){for(f=p.length,o=0;o<f;o+=1)c[o]=r(o,p)||"null";return i=0===c.length?"[]":s?"[\n"+s+c.join(",\n"+s)+"\n"+a+"]":"["+c.join(",")+"]",s=a,i}if(y&&"object"==typeof y)for(f=y.length,o=0;o<f;o+=1)"string"==typeof y[o]&&(i=r(u=y[o],p))&&c.push(n(u)+(s?": ":":")+i);else for(u in p)Object.prototype.hasOwnProperty.call(p,u)&&(i=r(u,p))&&c.push(n(u)+(s?": ":":")+i);return i=0===c.length?"{}":s?"{\n"+s+c.join(",\n"+s)+"\n"+a+"}":"{"+c.join(",")+"}",s=a,i}}var o=/^[\],:{}\s]*$/,u=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,c=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=t,Number.prototype.toJSON=t,String.prototype.toJSON=t);var s,l,p,y;"function"!=typeof JSON.stringify&&(p={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var o;if(s="",l="","number"==typeof n)for(o=0;o<n;o+=1)l+=" ";else"string"==typeof n&&(l=n);if(y=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return r("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){function n(e,r){var o,u,i=e[r];if(i&&"object"==typeof i)for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&((u=n(i,o))!==undefined?i[o]=u:delete i[o]);return t.call(e,r,i)}var r;if(e=String(e),a.lastIndex=0,a.test(e)&&(e=e.replace(a,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),o.test(e.replace(u,"@").replace(i,"]").replace(f,"")))return r=eval("("+e+")"),"function"==typeof t?n({"":r},""):r;throw new SyntaxError("JSON.parse")})}();var r={execute:function(r){var o,u={valid:!0},i=!!r.scalar,f=new ActiveXObject("ADODB.Connection");i&&(o=new ActiveXObject("ADODB.Recordset")),f.CursorLocation=3;try{f.Open(r.connection),f.Execute(r.sql),i&&(o.Open(r.scalar,f,0,1),u.records=t(o))}catch(c){u.valid=!1,u.message=c.message}e(u),n(f),i&&n(o)},query:function(r){var o=!!r.desc,u=new ActiveXObject("ADODB.Connection"),i=new ActiveXObject("ADODB.Recordset"),f={valid:!0};u.CursorLocation=3;try{u.Open(r.connection),i.Open(r.sql,u,0,1),f.records=t(i,o)}catch(c){f.valid=!1,f.message=c.message}e(f),n(i),n(u)}};try{r[WScript.Arguments(0)](JSON.parse(decodeURI(WScript.Arguments(1))))}catch(o){e({valid:!1,message:o.message})}}();