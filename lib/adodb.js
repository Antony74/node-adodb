!function(){"use strict";function e(e){try{WScript.StdOut.Write(encodeURI(n.stringify(e)))}catch(t){WScript.StdOut.Write(encodeURI(n.stringify({valid:!1,message:t.message})))}}function t(e,t){var r=[],n=!!t,c=e.Fields,o=c.Count;if(!e.BOF||!e.EOF){var a,i,s,l,u,f,h,g,p,y;for(e.MoveFirst();!e.EOF;){for(y={},a=0;a<o;a++)if(p=c.Item(a),g=p.Name,"date"==typeof(s=p.Value)&&(s=new Date(s)),n){for(u={},h=(f=p.Properties).Count,i=0;i<h;i++)u[(l=f.Item(i)).Name]={Type:l.Type,Value:l.Value};y[g]={ActualSize:p.ActualSize,Attributes:p.Attributes,DefinedSize:p.DefinedSize,NumericScale:p.NumericScale,Precision:p.Precision,Type:p.Type,Properties:u,Value:s}}else y[g]=s;r.push(y),e.MoveNext()}}return r}function r(e){e.State&&e.Close()}var n=function(){function e(r){if(e[r]!==a)return e[r];var n;if("bug-string-char-index"===r)n="a"!="a"[0];else if("json"===r)n=e("json-stringify")&&e("json-parse");else{var c,o='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"===r){var i=t.stringify,u="function"==typeof i&&l;if(u){(c=function(){return 1}).toJSON=c;try{u="0"===i(0)&&"0"===i(new Number)&&'""'===i(new String)&&i(s)===a&&i(a)===a&&i()===a&&"1"===i(c)&&"[1]"===i([c])&&"[null]"===i([a])&&"null"===i(null)&&"[null,null,null]"===i([a,s,null])&&i({a:[c,!0,!1,null,"\0\b\n\f\r\t"]})===o&&"1"===i(null,c)&&"[\n 1,\n 2\n]"===i([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'===i(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'===i(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'===i(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'===i(new Date(-1))}catch(g){u=!1}}n=u}if("json-parse"===r){var f=t.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){var h=5===(c=f(o)).a.length&&1===c.a[0];if(h){try{h=!f('"\t"')}catch(g){}if(h)try{h=1!==f("01")}catch(g){}if(h)try{h=1!==f("1.")}catch(g){}}}}catch(g){h=!1}n=h}}return e[r]=!!n}var t={},r=this.JSON,n={"function":!0,object:!0};r&&"object"==typeof r&&(t=r);var c,o,a,i=Object.prototype,s=i.toString,l=new Date(-0xc782b5b800cec);try{l=-109252===l.getUTCFullYear()&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10===l.getUTCHours()&&37===l.getUTCMinutes()&&6===l.getUTCSeconds()&&708===l.getUTCMilliseconds()}catch(_){}if(!e("json")){var u=e("bug-string-char-index");if(!l)var f=Math.floor,h=[0,31,59,90,120,151,181,212,243,273,304,334],g=function(e,t){return h[t]+365*(e-1970)+f((e-1969+(t=+(t>1)))/4)-f((e-1901+t)/100)+f((e-1601+t)/400)};if((c=i.hasOwnProperty)||(c=function(e){var t,r={};return(r.__proto__=null,r.__proto__={toString:1},r).toString!=s?c=function(e){var t=this.__proto__,r=e in(this.__proto__=null,this);return this.__proto__=t,r}:(t=r.constructor,c=function(e){var r=(this.constructor||t).prototype;return e in this&&!(e in r&&this[e]===r[e])}),r=null,c.call(this,e)}),o=function(e,t){var r,a,i,l=0;(r=function(){this.valueOf=0}).prototype.valueOf=0,a=new r;for(i in a)c.call(a,i)&&l++;return r=a=null,l?o=2===l?function(e,t){var r,n={},o="[object Function]"===s.call(e);for(r in e)o&&"prototype"===r||c.call(n,r)||!(n[r]=1)||!c.call(e,r)||t(r)}:function(e,t){var r,n,o="[object Function]"===s.call(e);for(r in e)o&&"prototype"===r||!c.call(e,r)||(n="constructor"===r)||t(r);(n||c.call(e,r="constructor"))&&t(r)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],o=function(e,t){var r,o,i="[object Function]"===s.call(e),l=!i&&"function"!=typeof e.constructor&&n[typeof e.hasOwnProperty]&&e.hasOwnProperty||c;for(r in e)i&&"prototype"===r||!l.call(e,r)||t(r);for(o=a.length;r=a[--o];l.call(e,r)&&t(r));}),o(e,t)},!e("json-stringify")){var p={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},y=function(e,t){return("000000"+(t||0)).slice(-e)},d=function(e){for(var t='"',r=0,n=e.length,c=!u||n>10,o=c&&(u?e.split(""):e);r<n;r++){var a=e.charCodeAt(r);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=p[a];break;default:if(a<32){t+="\\u00"+y(2,a.toString(16));break}t+=c?o[r]:e.charAt(r)}}return t+'"'},b=function(e,t,r,n,i,l,u){var h,p,v,j,C,A,S,O,m,T,w,_,D,U,N,F;try{h=t[e]}catch(_){}if("object"==typeof h&&h)if("[object Date]"!==(p=s.call(h))||c.call(h,"toJSON"))"function"==typeof h.toJSON&&("[object Number]"!=p&&"[object String]"!=p&&"[object Array]"!=p||c.call(h,"toJSON"))&&(h=h.toJSON(e));else if(h>-1/0&&h<1/0){if(g){for(C=f(h/864e5),v=f(C/365.2425)+1970-1;g(v+1,0)<=C;v++);for(j=f((C-g(v,0))/30.42);g(v,j+1)<=C;j++);C=1+C-g(v,j),S=f((A=(h%864e5+864e5)%864e5)/36e5)%24,O=f(A/6e4)%60,m=f(A/1e3)%60,T=A%1e3}else v=h.getUTCFullYear(),j=h.getUTCMonth(),C=h.getUTCDate(),S=h.getUTCHours(),O=h.getUTCMinutes(),m=h.getUTCSeconds(),T=h.getUTCMilliseconds();h=(v<=0||v>=1e4?(v<0?"-":"+")+y(6,v<0?-v:v):y(4,v))+"-"+y(2,j+1)+"-"+y(2,C)+"T"+y(2,S)+":"+y(2,O)+":"+y(2,m)+"."+y(3,T)+"Z"}else h=null;if(r&&(h=r.call(t,e,h)),null===h)return"null";if("[object Boolean]"===(p=s.call(h)))return""+h;if("[object Number]"===p)return h>-1/0&&h<1/0?""+h:"null";if("[object String]"===p)return d(""+h);if("object"==typeof h){for(U=u.length;U--;)if(u[U]===h)throw TypeError();if(u.push(h),w=[],N=l,l+=i,"[object Array]"===p){for(D=0,U=h.length;D<U;D++)_=b(D,h,r,n,i,l,u),w.push(_===a?"null":_);F=w.length?i?"[\n"+l+w.join(",\n"+l)+"\n"+N+"]":"["+w.join(",")+"]":"[]"}else o(n||h,function(e){var t=b(e,h,r,n,i,l,u);t!==a&&w.push(d(e)+":"+(i?" ":"")+t)}),F=w.length?i?"{\n"+l+w.join(",\n"+l)+"\n"+N+"}":"{"+w.join(",")+"}":"{}";return u.pop(),F}};t.stringify=function(e,t,r){var c,o,a,i;if(n[typeof t]&&t)if("[object Function]"===(i=s.call(t)))o=t;else if("[object Array]"===i){a={};for(var l,u=0,f=t.length;u<f;l=t[u++],("[object String]"===(i=s.call(l))||"[object Number]"===i)&&(a[l]=1));}if(r)if("[object Number]"===(i=s.call(r))){if((r-=r%1)>0)for(c="",r>10&&(r=10);c.length<r;c+=" ");}else"[object String]"===i&&(c=r.length<=10?r:r.slice(0,10));return b("",(l={},l[""]=e,l),o,a,c,"",[])}}if(!e("json-parse")){var v,j,C=String.fromCharCode,A={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},S=function(){throw v=j=null,SyntaxError()},O=function(){for(var e,t,r,n,c,o=j,a=o.length;v<a;)switch(c=o.charCodeAt(v)){case 9:case 10:case 13:case 32:v++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=u?o.charAt(v):o[v],v++,e;case 34:for(e="@",v++;v<a;)if((c=o.charCodeAt(v))<32)S();else if(92===c)switch(c=o.charCodeAt(++v)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=A[c],v++;break;case 117:for(t=++v,r=v+4;v<r;v++)(c=o.charCodeAt(v))>=48&&c<=57||c>=97&&c<=102||c>=65&&c<=70||S();e+=C("0x"+o.slice(t,v));break;default:S()}else{if(34===c)break;for(c=o.charCodeAt(v),t=v;c>=32&&92!=c&&34!=c;)c=o.charCodeAt(++v);e+=o.slice(t,v)}if(34===o.charCodeAt(v))return v++,e;S();default:if(t=v,45===c&&(n=!0,c=o.charCodeAt(++v)),c>=48&&c<=57){for(48===c&&(c=o.charCodeAt(v+1))>=48&&c<=57&&S(),n=!1;v<a&&(c=o.charCodeAt(v))>=48&&c<=57;v++);if(46===o.charCodeAt(v)){for(r=++v;r<a&&(c=o.charCodeAt(r))>=48&&c<=57;r++);r===v&&S(),v=r}if(101===(c=o.charCodeAt(v))||69===c){for(43!==(c=o.charCodeAt(++v))&&45!==c||v++,r=v;r<a&&(c=o.charCodeAt(r))>=48&&c<=57;r++);r===v&&S(),v=r}return+o.slice(t,v)}if(n&&S(),"true"===o.slice(v,v+4))return v+=4,!0;if("false"===o.slice(v,v+5))return v+=5,!1;if("null"===o.slice(v,v+4))return v+=4,null;S()}return"$"},m=function(e){var t,r;if("$"===e&&S(),"string"==typeof e){if("@"===(u?e.charAt(0):e[0]))return e.slice(1);if("["===e){for(t=[];"]"!==(e=O());r||(r=!0))r&&(","===e?"]"===(e=O())&&S():S()),","===e&&S(),t.push(m(e));return t}if("{"===e){for(t={};"}"!==(e=O());r||(r=!0))r&&(","===e?"}"===(e=O())&&S():S()),","!==e&&"string"==typeof e&&"@"==(u?e.charAt(0):e[0])&&":"==O()||S(),t[e.slice(1)]=m(O());return t}S()}return e},T=function(e,t,r){var n=w(e,t,r);n===a?delete e[t]:e[t]=n},w=function(e,t,r){var n,c=e[t];if("object"==typeof c&&c)if("[object Array]"===s.call(c))for(n=c.length;n--;)T(c,n,r);else o(c,function(e){T(c,e,r)});return r.call(e,t,c)};t.parse=function(e,t){var r,n;return v=0,j=""+e,r=m(O()),"$"!=O()&&S(),v=j=null,t&&"[object Function]"===s.call(t)?w((n={},n[""]=r,n),"",t):r}}}return t}(),c={execute:function(n){var c,o={valid:!0},a=!!n.scalar,i=new ActiveXObject("ADODB.Connection");a?(c=new ActiveXObject("ADODB.Recordset"),o.message=n.sql+" / "+n.scalar+" success"):o.message=n.sql+" success",i.CursorLocation=3;try{i.Open(n.connection),i.Execute(n.sql),a&&(c.Open(n.scalar,i,0,1),o.records=t(c),0===o.records.length&&(o.message="The scalar recordset is empty"))}catch(s){o.valid=!1,o.message=s.message}finally{r(i),a&&r(c)}e(o)},query:function(n){var c=!!n.desc,o=new ActiveXObject("ADODB.Connection"),a=new ActiveXObject("ADODB.Recordset"),i={valid:!0,message:n.sql+" success"};o.CursorLocation=3;try{o.Open(n.connection),a.Open(n.sql,o,0,1),i.records=t(a,c),0===i.records.length&&(i.message="The recordset is empty")}catch(s){i.valid=!1,i.message=s.message}finally{r(a),r(o)}e(i)}};try{c[WScript.Arguments(0)](n.parse(decodeURI(WScript.Arguments(1))))}catch(o){e({valid:!1,message:o.message})}}();