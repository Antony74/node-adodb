!function(){"use strict";function e(e){WScript.StdOut.Write(encodeURI(JSON.stringify(e)))}function t(e){var t=[],n=e.Fields,r=n.Count;if(!e.BOF||!e.EOF){var o,i,u,c;for(e.MoveFirst();!e.EOF;){for(i={},o=0;o<r;o++)"date"==typeof(c=(u=n.Item(o)).Value)&&(c=new Date(c),c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()))),i[u.Name]=c;t.push(i),e.MoveNext()}}return t}function n(e){for(var t={},n=e.Properties,r=n.Count,o=0;o<r;o++)prop=n.Item(o),t[prop.Name]={Type:prop.Type,Value:prop.Value};return t}function r(e){var t={};if(!e.BOF||!e.EOF)for(var r,o=e.Fields,i=o.Count,u=0;u<i;u++)t[(r=o.Item(u)).Name]={Attributes:r.Attributes,DefinedSize:r.DefinedSize,NumericScale:r.NumericScale,Precision:r.Precision,Type:r.Type,Properties:n(r)};return t}function o(e){e.State&&e.Close()}"object"!=typeof JSON&&(JSON={}),function(){function e(e){return e<10?"0"+e:e}function t(){return this.valueOf()}function n(e){return a.lastIndex=0,a.test(e)?'"'+e.replace(a,function(e){var t=l[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function r(e,t){var o,i,u,c,a,f=s,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof y&&(l=y.call(t,e,l)),typeof l){case"string":return n(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(s+=p,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(c=l.length,o=0;o<c;o+=1)a[o]=r(o,l)||"null";return u=0===a.length?"[]":s?"[\n"+s+a.join(",\n"+s)+"\n"+f+"]":"["+a.join(",")+"]",s=f,u}if(y&&"object"==typeof y)for(c=y.length,o=0;o<c;o+=1)"string"==typeof y[o]&&(u=r(i=y[o],l))&&a.push(n(i)+(s?": ":":")+u);else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(u=r(i,l))&&a.push(n(i)+(s?": ":":")+u);return u=0===a.length?"{}":s?"{\n"+s+a.join(",\n"+s)+"\n"+f+"}":"{"+a.join(",")+"}",s=f,u}}var o=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,c=/(?:^|:|,)(?:\s*\[)+/g,a=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=t,Number.prototype.toJSON=t,String.prototype.toJSON=t);var s,p,l,y;"function"!=typeof JSON.stringify&&(l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var o;if(s="",p="","number"==typeof n)for(o=0;o<n;o+=1)p+=" ";else"string"==typeof n&&(p=n);if(y=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return r("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){function n(e,r){var o,i,u=e[r];if(u&&"object"==typeof u)for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&((i=n(u,o))!==undefined?u[o]=i:delete u[o]);return t.call(e,r,u)}var r;if(e=String(e),f.lastIndex=0,f.test(e)&&(e=e.replace(f,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),o.test(e.replace(i,"@").replace(u,"]").replace(c,"")))return r=eval("("+e+")"),"function"==typeof t?n({"":r},""):r;throw new SyntaxError("JSON.parse")})}();var i={execute:function(n){var r,i={valid:!0},u=!!n.scalar,c=new ActiveXObject("ADODB.Connection");u&&(r=new ActiveXObject("ADODB.Recordset")),c.CursorLocation=3;try{c.Open(n.connection),c.Execute(n.sql),u&&(r.Open(n.scalar,c,0,1),i.records=t(r))}catch(a){i.valid=!1,i.message=a.message}e(i),o(c),u&&o(r)},query:function(n){var i=!!n.schema,u=new ActiveXObject("ADODB.Connection"),c=new ActiveXObject("ADODB.Recordset"),a={valid:!0};u.CursorLocation=2;try{u.Open(n.connection),c.Open(n.sql,u,0,1),a.records=t(c),i&&(a.schema=r(c))}catch(f){a.valid=!1,a.message=f.message}e(a),o(c),o(u)},openSchema:function(n){var r=new ActiveXObject("ADODB.Connection"),i={valid:!0};r.CursorLocation=2;try{r.Open(n.connection),n.schemaId?recordset=r.OpenSchema(n.queryType,n.criteria?n.criteria:null,n.schemaId):recordset=r.OpenSchema(n.queryType,n.criteria?n.criteria:null),i.records=t(recordset)}catch(u){i.valid=!1,i.message=u.message}e(i),o(recordset),o(r)}};try{i[WScript.Arguments(0)](JSON.parse(decodeURI(WScript.Arguments(1))))}catch(u){e({valid:!1,message:u.message})}}();