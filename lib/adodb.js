!function(){"use strict";function e(e){try{WScript.StdOut.Write(encodeURI(JSON.stringify(e)))}catch(t){WScript.StdOut.Write(encodeURI(JSON.stringify({valid:!1,message:t.message})))}}function t(e){var t,n,r=[],a=e.Fields.Count;if(!e.BOF||!e.EOF)for(e.MoveFirst();!e.EOF;){t={};for(var i=0;i<a;i++)if("date"==typeof(n=e.Fields.Item(i)).value){var o=new Date(n.value);o=new Date(Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds())),t[n.name]=o}else t[n.name]=n.value;r.push(t),e.MoveNext()}return r}function n(e){e.State&&e.Close()}function r(e,t){return stringValue=e[t],stringValue||t}function a(e,t){var n={};for(var r in o){var a=e[r];r&t&&(n[a]=!0,t-=r)}return t&&(n[t]=!0),n}"object"!=typeof JSON&&(JSON={}),function(){function e(e){return e<10?"0"+e:e}function t(){return this.valueOf()}function n(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(e){var t=f[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function r(e,t){var a,i,o,u,s,d=l,f=t[e];switch(!f||"object"!=typeof f&&"date"!=typeof f||"function"!=typeof f.toJSON||(f=f.toJSON(e)),"function"==typeof p&&(f=p.call(t,e,f)),typeof f){case"string":return n(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(l+=c,s=[],"[object Array]"===Object.prototype.toString.apply(f)){for(u=f.length,a=0;a<u;a+=1)s[a]=r(a,f)||"null";return o=0===s.length?"[]":l?"[\n"+l+s.join(",\n"+l)+"\n"+d+"]":"["+s.join(",")+"]",l=d,o}if(p&&"object"==typeof p)for(u=p.length,a=0;a<u;a+=1)"string"==typeof p[a]&&(o=r(i=p[a],f))&&s.push(n(i)+(l?": ":":")+o);else for(i in f)Object.prototype.hasOwnProperty.call(f,i)&&(o=r(i,f))&&s.push(n(i)+(l?": ":":")+o);return o=0===s.length?"{}":l?"{\n"+l+s.join(",\n"+l)+"\n"+d+"}":"{"+s.join(",")+"}",l=d,o}}var a=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,u=/(?:^|:|,)(?:\s*\[)+/g,s=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=t,Number.prototype.toJSON=t,String.prototype.toJSON=t);var l,c,f,p;"function"!=typeof JSON.stringify&&(f={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var a;if(l="",c="","number"==typeof n)for(a=0;a<n;a+=1)c+=" ";else"string"==typeof n&&(c=n);if(p=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return r("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){function n(e,r){var a,i,o=e[r];if(o&&"object"==typeof o)for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&((i=n(o,a))!==undefined?o[a]=i:delete o[a]);return t.call(e,r,o)}var r;if(e=String(e),d.lastIndex=0,d.test(e)&&(e=e.replace(d,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),a.test(e.replace(i,"@").replace(o,"]").replace(u,"")))return r=eval("("+e+")"),"function"==typeof t?n({"":r},""):r;throw new SyntaxError("JSON.parse")})}();var i={8192:"AdArray",20:"adBigInt",128:"adBinary",11:"adBoolean",8:"adBSTR",136:"adChapter",129:"adChar",6:"adCurrency",7:"adDate",133:"adDBDate",134:"adDBTime",135:"adDBTimeStamp",14:"adDecimal",5:"adDouble",0:"adEmpty",10:"adError",64:"adFileTime",72:"adGUID",9:"adIDispatch",3:"adInteger",13:"adIUnknown",205:"adLongVarBinary",201:"adLongVarChar",203:"adLongVarWChar",131:"adNumeric",138:"adPropVariant",4:"adSingle",2:"adSmallInt",16:"adTinyInt",21:"adUnsignedBigInt",19:"adUnsignedInt",18:"adUnsignedSmallInt",17:"adUnsignedTinyInt",132:"adUserDefined",204:"adVarBinary",200:"adVarChar",12:"adVariant",139:"adVarNumeric",202:"adVarWChar",130:"adWChar"},o={4096:"adFldCacheDeferred",16:"adFldFixed",8192:"adFldIsChapter",262144:"adFldIsCollection",32768:"adFldKeyColumn",131072:"adFldIsDefaultStream",32:"adFldIsNullable",65536:"adFldIsRowURL",128:"adFldLong",64:"adFldMayBeNull",2:"adFldMayDefer",16384:"adFldNegativeScale",256:"adFldRowID",512:"adFldRowVersion",8:"adFldUnknownUpdatable",4294967295:"adFldUnspecified",4:"adFldUpdatable"},u={execute:function(t){var r=!0,a=t.sql+" success",i=new ActiveXObject("ADODB.Connection");i.CursorLocation=3;try{i.Open(t.connection),i.Execute(t.sql)}catch(o){r=!1,a=o.message}finally{n(i)}e({valid:r,message:a})},scalar:function(r){var a,i=!0,o=r.sql+" / "+r.scalar+" success",u=new ActiveXObject("ADODB.Connection"),s=new ActiveXObject("ADODB.Recordset");u.CursorLocation=3;try{u.Open(r.connection),u.Execute(r.sql),s.Open(r.scalar,u,0,1),0===(a=t(s)).length&&(o="The scalar recordset is empty")}catch(d){i=!1,o=d.message}finally{n(s),n(u)}e({valid:i,message:o,records:a})},query:function(u){var s,d=!0,l=u.sql+" success",c=new ActiveXObject("ADODB.Connection"),f=new ActiveXObject("ADODB.Recordset");u.fields||(c.CursorLocation=3);try{c.Open(u.connection),f.Open(u.sql,c,0,1),s=t(f);var p=undefined;if(u.fields){p={};for(var g=f.Fields.Count,y=0;y<g;y++){field=f.Fields.Item(y);for(var S=field.Properties,O=S.Count,h={},m=0;m<O;m++)prop=S.Item(m),h[prop.Name]={Type:r(i,prop.Type),Value:prop.Value};p[field.name]={Attributes:a(o,field.Attributes),DefinedSize:field.DefinedSize,NumericScale:field.NumericScale,Precision:field.Precision,Properties:h,Type:r(i,field.Type)}}}0===s.length&&(l="The recordset is empty")}catch(v){d=!1,l=v.message}finally{n(f),n(c)}e({valid:d,message:l,records:s,fields:p})}};try{u[WScript.Arguments(0)](JSON.parse(decodeURI(WScript.Arguments(1))))}catch(s){e({valid:!1,message:s.message})}}();