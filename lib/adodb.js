!function(){"use strict";function e(e){try{WScript.StdOut.Write(n.encode(JSON.stringify(e)))}catch(t){WScript.StdOut.Write(n.encode(JSON.stringify({valid:!1,message:t.message})))}}function t(e){var t,n,r=[],o=e.Fields.Count;if(!e.BOF||!e.EOF)for(e.MoveFirst();!e.EOF;){t={};for(var u=0;u<o;u++)n=e.Fields.Item(u),t[n.name]=n.value;r.push(t),e.MoveNext()}return r}"object"!=typeof JSON&&(JSON={}),function(){function e(e){return e<10?"0"+e:e}function t(){return this.valueOf()}function n(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(e){var t=p[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function r(e,t){var o,u,c,i,s,f=a,p=t[e];switch(!p||"object"!=typeof p&&"date"!=typeof p||"function"!=typeof p.toJSON||(p=p.toJSON(e)),"function"==typeof y&&(p=y.call(t,e,p)),typeof p){case"string":return n(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(a+=l,s=[],"[object Array]"===Object.prototype.toString.apply(p)){for(i=p.length,o=0;o<i;o+=1)s[o]=r(o,p)||"null";return c=0===s.length?"[]":a?"[\n"+a+s.join(",\n"+a)+"\n"+f+"]":"["+s.join(",")+"]",a=f,c}if(y&&"object"==typeof y)for(i=y.length,o=0;o<i;o+=1)"string"==typeof y[o]&&(u=y[o],c=r(u,p),c&&s.push(n(u)+(a?": ":":")+c));else for(u in p)Object.prototype.hasOwnProperty.call(p,u)&&(c=r(u,p),c&&s.push(n(u)+(a?": ":":")+c));return c=0===s.length?"{}":a?"{\n"+a+s.join(",\n"+a)+"\n"+f+"}":"{"+s.join(",")+"}",a=f,c}}var o=/^[\],:{}\s]*$/,u=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,c=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=t,Number.prototype.toJSON=t,String.prototype.toJSON=t);var a,l,p,y;"function"!=typeof JSON.stringify&&(p={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var o;if(a="",l="","number"==typeof n)for(o=0;o<n;o+=1)l+=" ";else"string"==typeof n&&(l=n);if(y=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return r("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){function n(e,r){var o,u,c=e[r];if(c&&"object"==typeof c)for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(u=n(c,o),void 0!==u?c[o]=u:delete c[o]);return t.call(e,r,c)}var r;if(e=String(e),f.lastIndex=0,f.test(e)&&(e=e.replace(f,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),o.test(e.replace(u,"@").replace(c,"]").replace(i,"")))return r=new Function("return ("+e+");")(),"function"==typeof t?n({"":r},""):r;throw new SyntaxError("JSON.parse")})}();var n={encode:function(e){var t,n=new ActiveXObject("MSXML2.DOMDocument"),r=new ActiveXObject("ADODB.Stream"),o=n.createElement("stream");return o.dataType="bin.base64",r.Charset="utf-8",r.Type=2,r.Open(),r.WriteText(e),r.Position=0,r.Type=1,o.nodeTypedValue=r.Read(-1),t=o.text,r.Close(),o=null,r=null,n=null,t},decode:function(e){var t,n=new ActiveXObject("MSXML2.DOMDocument"),r=new ActiveXObject("ADODB.Stream"),o=n.createElement("stream");return o.dataType="bin.base64",o.text=e,r.Charset="utf-8",r.Type=1,r.Open(),r.Write(o.nodeTypedValue),r.Position=0,r.Type=2,t=r.ReadText(-1),r.Close(),o=null,r=null,n=null,t}},r={execute:function(t){var n=!0,r=t.sql+" success",o=new ActiveXObject("ADODB.Connection");try{o.Open(t.connection),o.Execute(t.sql)}catch(u){n=!1,r=u.message}finally{o.Close(),o=null}e({valid:n,message:r})},scalar:function(n){var r,o=!0,u=n.sql+" / "+n.scalar+" success",c=new ActiveXObject("ADODB.Connection"),i=new ActiveXObject("ADODB.Recordset");try{c.Open(n.connection),c.Execute(n.sql),i.Open(n.scalar,c,0,1),r=t(i),0===r.length&&(u="The scalar recordset is empty")}catch(s){o=!1,u=s.message}finally{i.Close(),c.Close(),i=null,c=null}e({valid:o,message:u,records:r})},query:function(n){var r,o=!0,u=n.sql+" success!",c=new ActiveXObject("ADODB.Connection"),i=new ActiveXObject("ADODB.Recordset");try{c.Open(n.connection),i.Open(n.sql,c,0,1),r=t(i),0===r.length&&(u="The recordset is empty")}catch(s){o=!1,u=s.message}finally{i.Close(),c.Close(),i=null,c=null}e({valid:o,message:u,records:r})}};try{r[WScript.Arguments(0)](JSON.parse(n.decode(WScript.Arguments(1))))}catch(o){e({valid:!1,message:o.message})}}();